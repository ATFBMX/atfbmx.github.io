<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Association of Toronto Flatlanders (ATF)</title>
  <meta name="description" content="ATF — Toronto Flatland BMX community: riders, videos, gallery, contact." />
  <meta property="og:title" content="Association of Toronto Flatlanders (ATF)" />
  <meta property="og:description" content="Flatland BMX in Toronto, Canada" />
  <meta property="og:type" content="website" />
  <link rel="preload" href="assets/style.css" as="style" />
  <link rel="stylesheet" href="assets/style.css" />
</head>
<body>
<header class="hero">
  <div class="wrap">
    <img src="assets/logo.png" alt="ATF logo" class="logo" />
    <h1>Association of Toronto Flatlanders</h1>
    <p class="tag">Flatland BMX in Toronto, Canada</p>
    <nav class="nav" aria-label="Primary">
      <a href="#about">Who We Are</a>
      <a href="#video">Video</a>
      <a href="#riders">Riders</a>
      <a href="#gallery">Gallery</a>
      <a href="#contact">Contact</a>
    </nav>
    <a class="cta" href="#video">Watch the clip ↓</a>
  </div>
</header>

<main class="wrap">
  <section id="about" class="block">
    <h2>Who We Are</h2>
    <p>We’re a community of Toronto flatland riders. We ride, mentor, run jams, and keep the scene moving.</p>
  </section>

  <section class="block">
    <h2>What We Do</h2>
    <ul class="bullets">
      <li>Open practice sessions & rider mentoring</li>
      <li>Local jams, demos & community events</li>
      <li>Beginner support: tips, setup, and progression</li>
    </ul>
  </section>

  <section id="video" class="block">
    <h2>Featured Video</h2>
    <div class="video-wrapper">
      <iframe
        src="https://www.youtube.com/embed/o8P-oUWC4Nw?rel=0"
        title="ATF Toronto Flatland — Featured Video"
        frameborder="0"
        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
        allowfullscreen
        referrerpolicy="strict-origin-when-cross-origin"></iframe>
    </div>
  </section>

  <!-- Riders -->
  <section id="riders" class="block">
    <h2>Riders</h2>
    <div id="riderGrid" class="grid" aria-live="polite"></div>
  </section>

  <!-- Gallery -->
  <section id="gallery" class="block">
    <h2>Gallery</h2>
    <div class="thumbs" id="galleryThumbs"></div>
  </section>

  <section id="contact" class="block contact">
    <h2>Contact</h2>
    <p>Want to ride with us, collab on an event, or learn flatland?</p>
    <p>Email: <a href="mailto:contact@atf-toronto.org">contact@atf-toronto.org</a></p>
    <p>Instagram: <a href="https://instagram.com/" target="_blank" rel="noopener">Follow us</a></p>
  </section>
</main>

<footer class="foot">
  <div class="wrap">
    <p>&copy; 2025 Association of Toronto Flatlanders</p>
  </div>
</footer>

<!-- Lightbox modal -->
<div class="lightbox" id="lightbox" aria-hidden="true" aria-label="Image viewer" role="dialog">
  <button class="close" id="lbClose" aria-label="Close (Esc)">Close ✕</button>
  <figure>
    <img id="lbImg" alt="Full-size gallery image" />
    <figcaption id="lbCap"></figcaption>
  </figure>
</div>

<script>
// ===== Placeholder path (uses your existing logo) =====
const PLACEHOLDER = 'assets/logo.png';

// Attach fallback to any <img data-fallback>
function attachFallbacks(scope = document) {
  scope.querySelectorAll('img[data-fallback]').forEach(img => {
    if (!img.getAttribute('src')) img.src = PLACEHOLDER;
    img.onerror = () => { img.onerror = null; img.src = PLACEHOLDER; };
  });
}

// ===== Riders (12 entries, blank img => placeholder) =====
const riders = [
  { name: 'Tall Paul', bio: 'Tech links, turbine spins, scene builder since day one.', linkText: 'Instagram', linkHref: '#', img: '' },
  { name: 'Bert', bio: 'Flow style, frontyard classics. Riding since 2004.', linkText: 'Profile', linkHref: '#', img: '' },
  { name: 'Brandon', bio: 'Fast combos, dialed whiplash control.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Juan', bio: 'Explosive switches, loves outdoor autumn sessions.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Colin', bio: 'Original lines, quiet killer at jams.', linkText: 'Insta', linkHref: '#', img: '' },
  { name: 'Jess', bio: 'Smooth turbines, backwheel consistency.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Remy', bio: 'Flatland lifer. Community first.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Andre', bio: 'Backyard scientist, loves bike setup chats.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Steph', bio: 'Rollers for days. New lines every session.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Maya', bio: 'Creative switches and footwork. New to comps.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Zhang', bio: 'Signature decade pivots, late-night Union rides.', linkText: 'Link', linkHref: '#', img: '' },
  { name: 'Ali', bio: 'Backwheel surgeon. Loves teaching beginners.', linkText: 'Link', linkHref: '#', img: '' }
];

const riderGrid = document.getElementById('riderGrid');
const riderCard = (r) => `
  <article class="card">
    <img src="${r.img || PLACEHOLDER}" data-fallback alt="${r.name}" loading="lazy" width="400" height="300"/>
    <div class="pad">
      <h3>${r.name}</h3>
      <p>${r.bio}</p>
      <a href="${r.linkHref}" target="_blank" rel="noopener">${r.linkText}</a>
    </div>
  </article>`;
riderGrid.innerHTML = riders.map(riderCard).join('');
attachFallbacks(riderGrid);

// ===== Gallery: responsive thumbs wrapped in anchors (progressive enhancement) =====
// Replace thumb/full paths later; placeholders work now.
const gallery = Array.from({ length: 8 }).map((_, i) => ({
  thumb: '',           // e.g. 'assets/gallery/thumbs/atf_01_480.jpg'
  full: '',            // e.g. 'assets/gallery/full/atf_01.jpg'
  alt: `ATF gallery ${i+1}`,
  caption: `ATF — placeholder ${i+1}`
}));

const thumbs = document.getElementById('galleryThumbs');
const thumbTpl = (p) => `
  <figure class="thumb">
    <a class="glink" href="${p.full || PLACEHOLDER}" data-full="${p.full || PLACEHOLDER}" data-caption="${p.caption}">
      <img src="${p.thumb || PLACEHOLDER}" data-fallback alt="${p.alt}" loading="lazy" width="320" height="240" />
    </a>
    <figcaption>${p.caption}</figcaption>
  </figure>`;
thumbs.innerHTML = gallery.map(thumbTpl).join('');
attachFallbacks(thumbs);

// ===== Lightbox (anchors intercept; degrades to opening image if JS off) =====
const lb = document.getElementById('lightbox');
const lbImg = document.getElementById('lbImg');
const lbCap = document.getElementById('lbCap');
const lbClose = document.getElementById('lbClose');

function openLB(src, caption) {
  lbImg.src = src || PLACEHOLDER;
  lbCap.textContent = caption || '';
  lb.setAttribute('aria-hidden','false');
  document.body.style.overflow='hidden';
  lbClose && lbClose.focus && lbClose.focus();
}
function closeLB() {
  lb.setAttribute('aria-hidden','true');
  lbImg.removeAttribute('src');
  document.body.style.overflow='';
}

// Intercept clicks on anchors in gallery to open lightbox
thumbs.addEventListener('click', (e) => {
  const link = e.target.closest('a.glink');
  if (!link) return;
  e.preventDefault();
  openLB(link.dataset.full || link.href, link.dataset.caption || '');
});

lbClose && lbClose.addEventListener('click', closeLB);
lb.addEventListener('click', (e)=>{ if(e.target === lb) closeLB(); });
document.addEventListener('keydown', (e)=>{ if(e.key==='Escape') closeLB(); });
</script>
</body>
</html>
